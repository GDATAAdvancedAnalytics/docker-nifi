language: "python"
python:
  - "3.5"
sudo: "required"
services:
  - docker
env:
  global:
    - DOCKER_REPOSITORY="mkobit/nifi"
    - DOCKER_USERNAME="mkobit"
    - secure: "mmlHOw5CqZOuRkFXSx9yq75RtoM7T4bHxZ29q4YHVWyGF8uLPNsq2vS3tLiXEHxb+3XfWopd+bdn35Wh1nZQXptLEFQA2XLM7TDBLd7FR4kGLue3SGAy0iRUD4WVOcCVF0YDYvYNhKacZMVLdY/J4zoKXIU8m6bUzzpI1x8TjkuQ8sXVSWvCyPrVn8173sMFVS4B7qhe/Gwk/wHVj7h8pWf8PtfHwkh+4dEHchhVBHm7k2vn24iyd2pJ4EM/TVBYjoKNHiQk0382FoBa4mYyIFXrrmPRUij2O18nM5czPyw/wpMwCFUfpQFeuERCxhhfwU0dU6btT1uuzLqwvHq2PlNEfW/INbE3nUfvUw18dxHmmXNqFDD2OylcXdRsumedG3pwWe3ZgK9RQTk0Dq1FzFUngjSG2lJX75yhxIhlH/2Bp0879Y75uGYpXguryI35jRYDGSOW/1iPI4L/VlUCexRVv1sTrfASfytCgrdm2Ak55TWvzG6op+Ps+JJrdE5uHHkJM1wBlKmCBGLQ8UQjxg85D9uBWwq3maXX+vg8lhW7DcN/QbKT+TjCfVq9rS1DtGl0EIIGN2sM7yUkOEGOEIjxnKtHXhyK0LVf7mQUuR59DnkxO/fglIHIDct2xkbP3IRokrEwgat2AHB58+XWE52XUi2UNVT52vv09uwHEf8="
    - secure: "OMGKm+fFnMih9egqLMGxYRiINp2dYTde2t7K4VZxKz5ZMsBI42KZvQ3j3/MTr8LB+Dbj1h44/rx/Fs+MflV/MvmTPWI5BMSZ3OVVdwA6nSdpt+sX4rZtGtys6a5WboI8kV8Jt6kZUMuYH51tz2dxy5iON6ady0aEDOuDwye2zjJ7B8m4nucQJ9skhYJGAmpz3CLR0IrAveiVZq9neZDpXlqTtzi230O1Yz2a/RzBzeaI4tutXbs5ewyhZCpxpvJ4YzNwbAhJNPD2+it5VGhJxUVaRfPs/h/yORwV1yvzko6Y2dsYWv7TAW5KUPfq8RY/1/Hjz4O54WuTsMVPT5+ZUhvuQ7xuUs8JvhSlAZsMUy1mcmQXY3GrVoI0+XZST2XIsPekSRlfLZrLOCPDYFBWlRmQfg/fYogujVyFWctj/D7DzrXLuVh5AZRrMwsotfcl0C1Vcgl12DiAEx3dh8m+aLwvLHJDMcygeyqhknMzRnLTIaAyxt8Uwn1nMNZokc/jZJHfGDHGhOPZ24AbvS0Ttp07FJCYGWwKxEDuE7nEG54UQj4G0UTe9LuxgQr4EY1krbKgH148+/VBy4eCGypqEnUu25MCP4wh+w6PrcGqBVziUvg2C8axYMM8h6+kyelxpVQvk92y74A+1FMldiKMvzZkUDKQbuKwinQwViwjWxo="
  matrix:
    - >-
      TEMPLATE_FILE="templates/Dockerfile-template"
      BASE_IMAGE="java:7"
      GIT_TAG_NAME="nifi-0.5.1"
      DOCKER_TAGS="0.5.1-openjdk-7"
      TEMPLATE_VALUES="base_image=java:7,nifi_version=0.5.1"
      DESTINATION="0.5.1-openjdk-7"
    - >-
      TEMPLATE_FILE="templates/Dockerfile-template"
      BASE_IMAGE="java:8"
      GIT_TAG_NAME="nifi-0.5.1"
      DOCKER_TAGS="0.5.1-openjdk-8,latest"
      TEMPLATE_VALUES="base_image=java:8,nifi_version=0.5.1"
      DESTINATION="0.5.1-openjdk-8"
    - >-
      TEMPLATE_FILE="templates/Dockerfile-template"
      BASE_IMAGE="java:9"
      GIT_TAG_NAME="nifi-0.5.1"
      DOCKER_TAGS="0.5.1-openjdk-9"
      TEMPLATE_VALUES="base_image=java:9,nifi_version=0.5.1"
      DESTINATION="0.5.1-openjdk-9"
before_script: ./make_docker.py -h
script: >-
  ./make_docker.py push
  --template-file $TEMPLATE_FILE
  --template-substitutions $TEMPLATE_VALUES
  --destination-file $DESTINATION
  --repository $DOCKER_REPOSITORY
  --tags $DOCKER_TAGS
  --username $DOCKER_USERNAME
  --email $DOCKER_EMAIL
  --password $DOCKER_PASSWORD
  --no-push
